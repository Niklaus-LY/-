

### 一、CPU

- 预备知识
  - **程序**：指示计算机每一步动作的一组指令
  - **程序的组成**：指令和数据
  - **机器语言**： CPU可以直接识别并使用的语言
  - **内存**：正在运行的程序的存储位置
  - **内存地址**：内存中，用来表示命令和数据存储位置的数值 
  - **CPU的功能**：解析和运行最终转换成机器语言的程序内容

#### 1.1 CPU的内存结构解析

- CPU的组成： **寄存器**、**控制器**、**运算器**和**时钟**（各部分之间用电流信号相互连通）

  <img src="/images/CPU的组成.png" alt="CPU的组成" style="zoom:67%;" />

  

- CPU和内存是由许多晶体管组成的电子部件，通常称为**IC** (Integrated Circuit, **集成电路**)，俗称**芯片**（CPU是集成电路的一种）。

  - **寄存器(register)**：暂存指令、数据等处理对象，可视作内存的一种。一个CPU内部会有20-100个寄存器。

  - **控制器(controller)**：负责把内存上的指令、数据等读入寄存器，并根据指令的执行结果来控制整个计算机。

  - **运算器(operator)**：负责运算从内存读入寄存器的数据。

  - **时钟 (clock)**： 负责发出CPU开始计时的时钟信号(clock puzzle)。

- **内存(memory)**：计算机的主存储器(main memory)， 简称**主存**。特点：

  - 由可读写元素构成，每个字节(8位)都有一个地址编号。CPU可通过地址对内存进行读取指令和数据。
  - 通过控制芯片等与CPU相连，主要负责存储指令和数据。
  - 主存中的指令和数据会随着计算机的关机而自动清除。

- 程序的运行流程：

  ​		程序启动后，根据时钟信号，控制器会从内存中读取指令和数据，通过对这些指令的解释和运行，运算器就会对数据进行运算，控制器根据该运算结果来控制计算机。

  <img src="/images/程序的运行流程.png" alt="程序的运行流程" style="zoom:67%;" />



#### 1.2 CPU是寄存器的集合体

- 程序是把**寄存器**作为对象来描述的

- 低级编程语言：汇编语言和机器语言

- **汇编(assembly)**：汇编语言 -> 机器语言

- 汇编器(assembler)：具有汇编功能的程序。

- **反汇编**：机器语言->汇编语言

- **编译(compile)**：高级语言->机器语言

- 编译器: 具有便于功能的程序

- 机器语言级别的程序是通过寄存器来处理的。![汇编语言程序示例](images\汇编语言示例.png)

- 寄存器的主要种类和功能：

  | 种类                                 | 功能                                                         |
  | :----------------------------------- | ------------------------------------------------------------ |
  | 累加寄存器(accumulator register)     | 存储执行运算的数据和运算后的数据                             |
  | 标志寄存器(flag register)            | 存储运算处理后的CPU的状态                                    |
  | 程序计数器(program counter)          | 存储下一条指令所在内存的地址，决定着程序的流程               |
  | 基址寄存器(base register)            | 存储数据内存的起始地址                                       |
  | 变址寄存器(index register)           | 存储基址寄存器的相对地址                                     |
  | 通用寄存器(general purpose register) | 存储任意数据                                                 |
  | 指令寄存器(instruction register)     | 存储指令。CPU内部使用，程序员无法通过程序对该寄存器进行读写操作 |
  | 栈寄存器(stack register)             | 存储栈区域的起始地址                                         |

- 程序员眼里的CPU 寄存器：

- <img src="images\程序员眼里的CPU寄存器.png" style="zoom:67%;" />

- **溢出(overflow)**：指的是运算的结果超出了寄存器的长度范围。

  

#### 1.3 决定程序流程的程序计数器

- 内存中配置的程序示例：<img src="images\内存中配置的程序示例.png" style="zoom:67%;" />



#### 1.4 条件分支和循环机制

- 顺序执行：按照地址内容的顺序执行命令，每执行一条指令程序计数器就自动加一

- 条件分支：根据条件执行任意地址的指令， 使用的是跳转指令

- 循环：重复执行同一地址的指令，使用的是跳转指令

- 执行条件分支的程序示例：<img src="images\执行条件分支的程序示例.png" style="zoom:67%;" />

  

#### 1.5 函数的调用机制

- **函数调用**：使用的是call指令，而不是跳转指令。在将函数的入口地址设定到程序计数器之前，call指令会把调用函数后要执行的指令地址存储在名为栈的主存内。函数处理完毕后，再通过函数的出口来执行return命令。**return命令的功能是把保存到栈中的地址设定到程序计数器中。**

- 程序函数调用示例：

- <img src="images\程序函数调用示例.png" style="zoom:67%;" />

  

- 程序计数器和栈的功能：

- <img src="images\程序计数器和栈的功能.png" style="zoom:67%;" />



#### 1.6 通过地址和索引实现数组

- 为了方便理解，计算机通常使用十六进制数代替二进制数。A~F分别表示10~15，这样32位的二进制数就可以使用8位的十六进制数来表示。

- 在查看地址时，CPU会把初始地址存入基址寄存器，把基址寄存器+变址寄存器的值解释为实际查看的内存地址。变址寄存器相当于高级编程语言程序中数组的索引功能。

  <img src="images\实际地址.png" style="zoom:67%;" />



#### 1.7 CPU的处理

- 机器语言指令的主要类型和功能：

| 类型             | 功能                                                         |
| ---------------- | ------------------------------------------------------------ |
| 数据转送指令     | 寄存器和内存、内存和内存、寄存器和外围设备之间的数据读写操作 |
| 运算指令         | 用累加寄存器执行算术运算、逻辑运算、比较运算和移位运算       |
| 跳转指令         | 实现条件分支、循环、强制跳转等                               |
| call\return 指令 | 函数的调用\返回调用前的地址                                  |



***



### 二、 数据

#### 2.1 用二进制表示计算机信息的原因

- CPU和内存都是IC的一种，IC的所有引脚只有直流电压0V或5V两种状态。IC的这个特性决定了计算机的信息数据只能用二进制来处理。
- **bit** 是二进制数位**binary digit**的缩写
- 8个二进制位数被称为一个**字节**。
- 使用字节单位处理数据时，如果数字小于存储的字节数，那么高位上就用0填补。

#### 2.1 什么是二进制数

<img src="\images\二进制数转十进制数.png" style="zoom:67%;" />



#### 2.3 移位运算和乘除运算的关系

- **移位运算**指的是将二进制数值的各数位进行左右位移的运算。

- 左移高位补0，右移补1或补0。

- 移位运算中溢出的数位直接**丢弃**。

- 左移相当于**乘以**2的n次幂，右移相当于**除以2**的n次幂(n是移动的位数)。

  

#### 2.4 便于计算机处理的"补数"

- 二进制中表示负数值时，一般会把最高位作为符号来使用。**符号位是0时表示正数 符号位为1时表示负数。**
- **计算机中只有加法运算**，在表示负数时使用补数来表示，即用正数表示负数。

- **取反**：0变1,1变0。
- 补数的操作：各数位**取反**，然后在取反的结果加一。

- 同样的位数下，计算机能表示的负数比正数多一个。但0被划分为正数。

  

#### 2.5 逻辑右移和算术右移的区别

- **逻辑移位**： 不考虑符号的移位，无论是左移还是右移，都在空出来位置补0。
- **算术移位**：考虑符号的移位，左移时在空出来的位置补0，右移时正数补0，负数补1。

- **符号扩充**：保持值不变的前提下将其向高位二进制数转换，正数补0，负数补1.

<img src="images\符号扩充.png" style="zoom:67%;" />



#### 2.6 逻辑运算

- **算术运算**：加减乘除四则运算。
- **逻辑运算**：对二进制位的各数字位的0和1分别进行处理的运算。
  - 逻辑非(**NOT**)：取反操作，0变1，1变0
  - 逻辑与(**AND**)：两个数值都是1时，结果才为1
  - 逻辑或(**OR**)：两个数值至少有一个1时，结果才为1
  - 逻辑异或(**XOR/EOR**, exclusive or)：两个数值不同时，结果才为1

- 图形模式的逻辑运算：<img src="images\图形模式的逻辑运算.png" style="zoom:67%;" />



---



### 三、 小数运算

- 计算机也存在计算错误的情况，小数运算就是例子。

  

#### 3.1 将0.1累加100次也得不到10

<img src="images\小数运算的不准确.png" style="zoom:67%;" />



#### 3.2 用二进制数表示小数

- 二进制表示小数的处理跟整数是一样的，将各个数位的数值跟问权相乘的结果相加就好。

- 二进制小数的**位权**：第一位是2的-1次幂，第二位是2的-2次幂···



#### 3.3 计算机运算出错的原因

- **原因**： 小数的位权无法组成所有小数数值

#### 3.4 什么是浮点数

- **浮点数**：用符号、尾数、基数和指数这四部分来表示的小数。

- **双精度浮点数**：用64位表示的小数，其中符号1位，指数11位，尾数52位
- **单精度浮点数**：用32位表示的小数其中符号1位，指数8位，尾数23位
- 表现形式：<img src="images\浮点数的表现形式.png" style="zoom:67%;" />



#### 3.7 如何避免计算机计算出错

1. 回避，无视这些错误。
2. 把小数转换成整数来计算。



#### 3.8 二进制数和十进制数

- 以位为单位表示数据时，使用二进制数很方便，如果位数太多看起来就比较麻烦。
- 十六进制数格式：数字开头加上0x





---



### 四、内存

- 预备知识：
  - 计算机是进行数据处理的设备，程序表示的是处理顺序和数据结构



#### 4.1 内存的物理机制

- 内存实际上是一种名为**内存IC**的电子元件

- 内存IC中有**电源**、**地址信号**、**数据信号**、**控制信号**等用于输入输出的大量引脚，**通过为其指定地址来进行数据读写**。**数据和地址的本质都是电信号**。

- 内存的形式:

  - DRAM(Dynamic Random Access Memory)：需要刷新才能保存数据
  - SRAM(Static Random Access Memory)：不需要刷新电路即能保存数据
  - ROM(Read Only Memory)：只能用来读取的内存  

- RAM内存IC示例:

   <img src="images\RAM的内存IC示例.png" style="zoom:60%;" />

  - 这个内存IC中数据引脚有**八个**表示**一次可以输入输出8位的数据**

  - 地址信号引脚有**十个**，可以指定1024个地址，即**可以存储1KB的数据**

  - 计算机领域中，**K表示的是2^10, 而1000通常用k来表示**

  - 如何写入1字节的数据：

    ​       首先给VCC接入+5V，给GND接入0V电源，并使用A0~A9的地址信号来指定数据的存储场所，然后再把数据的值输入给D0~D7的数据信号，并把WR信号设定为1

    <img src="E:\GitProject\程序员的自我救赎\images\内存的数据读写.png" style="zoom:60%;" />



#### 4.2 内存的逻辑模型

- 内存模型：

  <img src="images\内存的模型.png"  />

- 编程语言中的**数据类型**表示存储的是何种类型的数据，从内存来看，就是**占有的内存大小**的意思。

- 内存存储字节节序：

  - 低节节序：将多字节的数据的低位字节存储在内存低位地址的方式

  - 高节节序：将多字节的数据的高位字节存储在内存低位地址的方式

    

#### 4.3 指针

- **指针也是一种变量，它所表示的不是数据的值，而是存储着数据的内存的地址**。通过指针，可以对任意指定地址的数据进行读写。



#### 4.4 数组，高效使用内存的基础

- **数组是指多个同样类型的数据在内存中连续排列的形式。**数组元素的各个数据会通过**连续的编号**被区分开来，这个编号称为**索引**。

<img src="images\数组.png" style="zoom:80%;" />

- **存取结构：**

  - **随机存取**：又叫直接存取，即可以通过下标直接访问的数据结构，与存储位置无关，存取第N个数据时，不需要访问前面N-1个数据即可对第N个数据进行操作。数组就是一种采用随机存取方式的数据结构。

  - **顺序存取**：跟随机存取相对，就是在存取第N个数据时，必须先访问前面的N-1个数据

- **存储结构：**

  - **顺序存储结构**：把逻辑上相邻的节点存储在物理位置上相邻的存储单元中，节点之间的逻辑关系有存储单元的邻接关系来体现，缺点是不便于修改。数组就是使用的顺序存储结构。 
  - **随机存储结构**：不要求逻辑相邻的元素在物理位置上也相邻，可用一组任意的存储单元存储数据元素，插入删除较为灵活，但也失去了随机存取的特点。



#### 4.5 栈、队列以及环形缓冲区

- 栈和队列都可以**不通过指定地址和索引来对数组的元素进行读写**，只需要预留出空间即可
- 两者区别：栈用的是**LIFO**(Last Input First Out)方式，而队列用的是**FIFO**(First Input First Out)方式

- 队列一般是以环状缓冲区(ring buffer) 的方式实现的。
- 环状缓冲区模型：<img src="images\环状缓冲区模型.png" style="zoom:80%;" />



#### 4.6 链表使元素的追加和删除更容易





---





### 五、磁盘

### 六、压缩数据

### 七、程序的运行环境

### 八、源文件，可执行文件

### 九、操作系统与应用

### 十、从汇编语言了解程序

### 十一、硬件控制

